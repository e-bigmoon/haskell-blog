<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">

  <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
  <!-- MUST in hex format, may the same as header-color. This color is for android chrome browser. -->
  <meta name="theme-color" content="#5c6bc0">

  <!-- Metadata. -->
  <meta name="keywords" content="haskell,blog,bigmoon" />
  <title>Stack 1.7.1 がリリースされました。</title>
  <meta name="description" content="はじめに
4月28日に Stack version 1.7.1 がリリースされました。
更新は以下のコマンドですぐに終わります。
$ stack upgrade
...

$ stack --version
Version 1.7.1, Git revision 681c800873816c022739ca7ed147">
  <link rel="canonical" href="../../posts/2018/05-04-stack171.html">
  <link rel="alternate" type="application/atom+xml" title="Stack 1.7.1 がリリースされました。" href="../../feed.xml" />
  <link rel="shortcut icon" href="../../images/favicon.ico" />
  <meta name="google-site-verification" content="X2YNboLvzw3_bclXLMvohyJDqj68D06_hPDMukRbgTs" />

  <!-- Stylesheets. -->
  <link rel="stylesheet" href="../../lib/materialize/css/materialize.min.css" />
  <link rel="stylesheet" href="../../css/main.css" />
  <link media="all" rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/3.3.92/css/materialdesignicons.min.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="../../lib/material-scrolltop/material-scrolltop.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />

  <!-- OGP -->
  <meta property="og:title" content="Stack 1.7.1 がリリースされました。" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="/posts/2018/05-04-stack171.html" />
  <!-- <meta property="og:image" content=" サムネイル画像の URL" /> -->
  <meta property="og:site_name" content="Stack 1.7.1 がリリースされました。" />
  <meta property="og:description" content="はじめに
4月28日に Stack version 1.7.1 がリリースされました。
更新は以下のコマンドですぐに終わります。
$ stack upgrade
...

$ stack --version
Version 1.7.1, Git revision 681c800873816c022739ca7ed147" />

  <meta name="twitter:card" content="summary" />
  <!-- <meta name="twitter:site" content="@[ Twitter ID]" /> -->
  <!-- <meta name="twitter:player" content="@[ Twitter ID]" /> -->

  <noscript>
  <div class="notice-warning noscript">You don't have javascript enabled. Good luck! :(</div>
</noscript>

<!--[if IE]>
  <div class="notice-warning">Oh, you are using Internet Explorer! Good luck... :(</div>
<![endif]-->

</head>


  <body>
    <header class="site-header">
      <nav class="nav-extended indigo lighten-1">
        <div class="nav-wrapper">
  <a href="../../"><span class="site-title">BIGMOON Haskeller's BLOG</span></a>
  <a href="#" data-activates="mobile-navbar" class="button-collapse">
    <i class="mdi mdi-menu white-text"></i>
  </a>

  <ul id="nav-mobile" class="right hide-on-med-and-down">
    <li>
      <a href="../../" class="white-text">
        <i class="mdi mdi-home left indigo-text text-lighten-3"></i>
        Home
      </a>
    </li>
    <li>
      <a href="../../about.html" class="white-text">
        <i class="mdi mdi-account-circle left indigo-text text-lighten-3"></i>
        About
      </a>
    </li>
    <li>
      <a href="../../stack/" class="white-text">
        <i class="mdi mdi-wrench left indigo-text text-lighten-3"></i>
        Development
      </a>
    </li>
    <li>
      <a href="../../quiz/index.html" class="white-text">
        <i class="mdi mdi-comment-question-outline left indigo-text text-lighten-3"></i>
        Quiz
      </a>
    </li>
    <li>
      <a href="../../libraries/" class="white-text">
        <i class="mdi mdi-package-variant left indigo-text text-lighten-3"></i>
        Libraries
      </a>
    </li>
    <li>
      <a href="../../yesod/" class="white-text">
        <i class="mdi mdi-earth left indigo-text text-lighten-3"></i>
        Yesod
      </a>
    </li>
    <li>
      <a href="../../contact.html" class="white-text">
        <i class="mdi mdi-lead-pencil left indigo-text text-lighten-3"></i>
        Contact
      </a>
    </li>
    <li>
      <a href="../../feed.xml" class="white-text">
        <i class="mdi mdi-rss left indigo-text text-lighten-3"></i>
        Feed
      </a>
    </li>
  </ul>

  <ul class="side-nav" id="mobile-navbar">
    <li>
      <a href="../../" class="waves-effect waves-teal black-text">
        <i class="mdi mdi-home left green-text"></i>
        Home
      </a>
    </li>
    <li>
      <a href="../../about.html" class="navbar-text-colour-mobile">
        <i class="mdi mdi-account-circle left blue-text"></i>
        About
      </a>
    </li>
    <li>
      <a href="../../stack/" class="navbar-text-colour-mobile">
        <i class="mdi mdi-wrench left blue-text"></i>
        Development
      </a>
    </li>
    <li>
      <a href="../../quiz/" class="navbar-text-colour-mobile">
        <i class="mdi mdi-comment-question-outline left blue-text"></i>
        Quiz
      </a>
    </li>
    <li>
      <a href="../../libraries/" class="navbar-text-colour-mobile">
        <i class="mdi mdi-package-variant left blue-text"></i>
        Libraries
      </a>
    </li>
    <li>
      <a href="../../yesod/" class="navbar-text-colour-mobile">
        <i class="mdi mdi-earth left blue-text"></i>
        Yesod
      </a>
    </li>
    <li>
      <a href="../../contact.html" class="navbar-text-colour-mobile">
        <i class="mdi mdi-lead-pencil left blue-text"></i>
        Contact
      </a>
    </li>
  </ul>
</div>

      </nav>
    </header>

    <div class="site-container" id="tab-main">
      <div class="wrapper">
        <div class="post-ribbon"></div>

<div class="container post-container">
  <div class="post-page card-panel z-depth-2">
    <div class="post-section">

      <p class="grey-text">
        <i class="mdi mdi-calendar"></i>&nbsp;
        Posted on May  4, 2018
        
        
          &nbsp;&nbsp;<i class="mdi mdi-account-circle"></i>&nbsp;
          authored by Shinya Yamaguchi
        
        &nbsp;
        
          <i class="mdi mdi-folder"></i>&nbsp;
          <span class="capitalize"></span>
          <!-- &emsp;<i class="mdi mdi-refresh"></i>&nbsp;UPDATE: {% if page.update %}{{ page.update | date: "%b %-d, %Y" }}{% else %}{{ page.last_modified_at | date: "%b %-d, %Y" }}{% endif %} -->
        
      </p>

      <div class="post-header">
        <h1 class="post-title">Stack 1.7.1 がリリースされました。</h1>

        <div class="row">
        
          <div class="col s6">
            <i class="post-tag mdi mdi-tag-multiple waves-effect waves-light"></i>
            <div class="chip"><a href="../../tags/bigmoon.html">bigmoon</a>, <a href="../../tags/stack.html">stack</a></div>
          </div>
        

          <div class="col s6">
            <div style="position: relative; top: 70px;">
            <div class="fixed-action-btn horizontal" style="position: absolute; display: inline-block; right: 24px;">
  <a class="btn-floating btn-large red">
    <i class="large material-icons">share</i>
  </a>
  <ul>
    <li>
      <a class="btn-floating waves-effect waves-light blue tooltipped" data-position="bottom" data-delay="20" data-tooltip="Share on Twitter" href="https://twitter.com/intent/tweet?text=Stack 1.7.1 がリリースされました。&url=https://haskell.e-bigmoon.com/posts/2018/05-04-stack171.html"><i class="mdi mdi-twitter white-text"></i></a>
    </li>
    <li>
      <a class="btn-floating waves-effect waves-light indigo tooltipped" data-position="bottom" data-delay="20" data-tooltip="Share on Facebook" href="https://facebook.com/sharer.php?u=https://haskell.e-bigmoon.com/posts/2018/05-04-stack171.html"><i class="mdi mdi-facebook white-text"></i></a>
    </li>
    <li>
      <a class="btn-floating waves-effect waves-light red tooltipped" data-position="bottom" data-delay="20" data-tooltip="Share on Google+" href="https://plus.google.com/share?url=https://haskell.e-bigmoon.com/posts/2018/05-04-stack171.html"><i class="mdi mdi-google-plus white-text"></i></a>
    </li>
  </ul>
</div>
            </div>
          </div>
        </div>
      </div>

      <article class="post-content">
        <h2 id="はじめに">はじめに</h2>
<p>4月28日に Stack version 1.7.1 が<a href="https://github.com/commercialhaskell/stack/blob/v1.7.1/ChangeLog.md#v171">リリース</a>されました。</p>
<p>更新は以下のコマンドですぐに終わります。</p>
<pre class="shell"><code>$ stack upgrade
...

$ stack --version
Version 1.7.1, Git revision 681c800873816c022739ca7ed14755e85a579565 (5807 commits) x86_64 hpack-0.28.2</code></pre>
<!--more-->
<h2 id="リリースノート">リリースノート</h2>
<ul>
<li><strong>aarch64 (64ビットARM) で初めて stack が利用できるようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/commit/9a23b91bd1ba4d120a77c9982e85079f825ebf06#diff-e705c8fadf1193ab59443a5e6c8cbe8b">9a23b91bd1ba4d120a77c9982e85079f825ebf06</a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>stack のダウンロードリンクが <code>https://www.stackage.org/stack/</code> から <code>https://get.haskellstack.org/stable/</code> に変わりました。</p>
<p>各種バイナリへのリンクは <code>https://get.haskellstack.org/stable/&lt;PLATFORM&gt;.&lt;EXTENSION&gt;</code> という形式になるようです。</p>
<ul>
<li><strong>GHC 8.2.2 への対応が困難なため、静的にリンクされた Alpine Linux 向け stack は利用できなくなりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/2387">Official support for Alpine Linux #2387</a>
</li>
<li>
<a href="https://ghc.haskell.org/trac/ghc/ticket/14739">Cannot compile ghc 8.2.1 or 8.2.2 on armv7l architectures</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/commit/9a23b91bd1ba4d120a77c9982e85079f825ebf06#diff-e705c8fadf1193ab59443a5e6c8cbe8b">9a23b91bd1ba4d120a77c9982e85079f825ebf06</a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>GHC 8.2.2 から CentOS 6 の 32-bit Linux GMP4 はサポートされなくなりました。そのため stack も利用できなくなりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3613">linux64-gmp4 variant for GHC 8.2.2 #3613</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/commit/9a23b91bd1ba4d120a77c9982e85079f825ebf06#diff-e705c8fadf1193ab59443a5e6c8cbe8b">9a23b91bd1ba4d120a77c9982e85079f825ebf06</a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>実際の<a href="https://github.com/commercialhaskell/stack/blob/9a23b91bd1ba4d120a77c9982e85079f825ebf06/etc/scripts/get-stack.sh#L224">コード</a>を見てみるとまだ使えそうな気がしますが、stack 1.7.1 からは<a href="https://github.com/commercialhaskell/stack/releases/download/v1.7.1/stack-1.7.1-linux-i386-gmp4.tar.gz">リンク切れ</a>になります。(stack v1.6.5 とかであれば<a href="https://github.com/commercialhaskell/stack/releases/download/v1.6.5/stack-1.6.5-linux-i386-gmp4.tar.gz">ダウンロード可能</a>です。)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1">  <span class="kw">else</span></a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="ex">install_dependencies</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">case</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span><span class="kw"> in</span></a>
<a class="sourceLine" id="cb2-4" title="4">      <span class="st">&quot;6&quot;</span><span class="kw">)</span></a>
<a class="sourceLine" id="cb2-5" title="5">        <span class="ex">print_bindist_notice</span> <span class="st">&quot;libgmp4&quot;</span></a>
<a class="sourceLine" id="cb2-6" title="6">        <span class="ex">install_32bit_gmp4_linked_binary</span></a>
<a class="sourceLine" id="cb2-7" title="7">        <span class="kw">;;</span></a>
<a class="sourceLine" id="cb2-8" title="8">      *<span class="kw">)</span></a>
<a class="sourceLine" id="cb2-9" title="9">        <span class="ex">print_bindist_notice</span></a>
<a class="sourceLine" id="cb2-10" title="10">        <span class="ex">install_32bit_standard_binary</span></a>
<a class="sourceLine" id="cb2-11" title="11">        <span class="kw">;;</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="kw">esac</span></a>
<a class="sourceLine" id="cb2-13" title="13">  <span class="kw">fi</span></a></code></pre></div>
<h3 id="大きな変更">大きな変更</h3>
<ul>
<li><strong>Cabal のバージョンを 2.0 から 2.2 にアップグレードしました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3878">Switch to Cabal 2.2 (prerelease) #3878</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<h3 id="変更点">変更点</h3>
<ul>
<li><strong>GCC を利用する Linux ディストリビューションで、デフォルトで PIE が有効になっている場合、<code>stack setup</code> コマンドは異なる GHC 設定オプションを利用しなくなりました。ghc-8.0.2 から GHC は自分自身で検出できるようになり、Stack’s attempted workaround for older versions caused more problems than it solved.</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3636">Setup fails with ‘No information found for ghc-8.2.2’ for OS key ‘linux64-ncurses6-nopie’ #3636</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3715">setup: improvements to selecting bindists on Linux #3715</a>
</li>
<li>
<a href="https://github.com/fpco/stackage-content/pull/34">stack-setup-2: nopie fixes for Arch, Gentoo, and Void Linux #34</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>いまいち良くわかってないですが、<a href="https://github.com/commercialhaskell/stack/pull/3715/files#diff-4968f87e674615592e572f2ec593e5b0L558">コードの差分</a>を見ると <code>noPie</code> に関する部分が全部削除されてるので、その辺りを GHC が上手く処理するようになったんでしょう・・・。</p>
<ul>
<li><strong><code>stack new</code> コマンドは、プロジェクトテンプレートに stack.yaml ファイルが含まれる場合に、初期化処理を行わないようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3888">Initialize a new project only when no stack.yaml #3888</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>今まで通り <code>stack.yaml</code> が含まれている場合でも初期化させたい場合は<code>forceOverwrite initOpts</code> が <code>True</code> になれば良いので、<code>--force</code> フラグをつければ良さそうですね。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb3-1" title="1"><span class="st">-        initProject IsNewCmd dir initOpts globalResolver</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="va">+        exists &lt;- doesFileExist $ dir &lt;/&gt; stackDotYaml</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="va">+        when (forceOverwrite initOpts || not exists) $</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="va">+            initProject IsNewCmd dir initOpts globalResolver</span></a></code></pre></div>
<h3 id="その他の改良点">その他の改良点</h3>
<ul>
<li><strong>stack に新たなサブコマンド <code>ls</code> が導入されました。このコマンドによってローカル及びリモートのスナップショットを確認することができます。詳細は <code>stack ls snapshots --help</code> コマンドでご確認ください。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/1614">A new stack show command and missing informative commands #1614</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3252">Introduce new sub command ls #3252</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>過去の<a href="../2017/12-20-stack-ls-command.html">ブログ記事</a>で紹介しているので気になる方はご参照ください。</p>
<ul>
<li><strong><code>list-dependencies</code> コマンドが廃止されます。同等の機能は <code>ls dependencies</code> コマンドで引き続き提供されます。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3669">Stack list-dependencies : Bring it under the new ls umbrella command #3669</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3706">Port <code>list-dependencies</code> under the new ls sub command #3706</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>v1.7.1 ではまだ利用できますが、以下のように <code>DEPRECATED</code> メッセージが表示されます。一応 v1.8 で削除される予定です。</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1">$ <span class="ex">stack</span> list-dependencies</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="ex">DEPRECATED</span>: Use ls dependencies instead. Will be removed in next major version.</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="ex">...</span></a></code></pre></div>
<ul>
<li><strong>全ての HTTP リクエストヘッダに User-Agent が追加されるようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3628">Specify User-Agent to get over my company’s firewall #3628</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3682/">Specify User-Agent on every HTTP request (#3628) #3682</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>今までは <code>User-Agent</code> が付いていなかったみたいですが、<code>The Haskell Stack</code> が全てのHTTPリクエストに対して付与されるようになったみたいです。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb5-1" title="1"><span class="va">+setUserAgent :: Request -&gt; Request</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="va">+setUserAgent = setRequestHeader &quot;User-Agent&quot; [&quot;The Haskell Stack&quot;]</span></a></code></pre></div>
<ul>
<li><strong><code>stack setup</code> コマンドは互換性のある GHC をインストールするために、任意の OS キーによるインストールを試すようになりました (これは OS キーをどれか1つだけチェックするよりも良い方法です)。この変更は Linux の各ディストリビューションで libinfo 5/6, ncurses 5/6, gmp 4/5 の異なった組み合わせに起因するものです。今後の GHC リリースを見据えて、セットアップに関する YAML メタデータをシンプルに保つことができます。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3521">Check for ncurses6 before checking for tinfo6 #3521</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3715">setup: improvements to selecting bindists on Linux #3715</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>ビルドプログレスバーが現在ビルドしているパッケージ名を表示するようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3763">Report currently building packages along with “Progress:” label #3763</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tbody>
</table>
<p>変更前の表示結果</p>
<pre><code>Progress: 3/74</code></pre>
<p>変更後の表示結果</p>
<pre><code>Progress: 3/74; [Cabal-2.0.1.1|basement-0.0.4|old-time-1.1.0.3|simple-sendfile-0.2.26|stm-2.4.4.1|stringsearch-0.3.6.6]</code></pre>
<ul>
<li><strong><code>stack setup --verbose</code> の出力に GHC 設定処理のログを含めるようにしました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3716">“stack setup –verbose” should also cause verbose output of GHC configure process if possible #3716</a>
</li>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3712">Never ending “Configuring GHC…” #3712</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3740">Log GHC configure output on <code>stack -v setup</code> #3740</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>変更前は以下のように <code>Configuring GHC ...</code> で何も表示されていなかったようです。</p>
<pre class="shell"><code>$ stack build --verbose
...

2017-12-27 00:30:23.869257: [debug] Run process: /home/gleb/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2.temp/ghc-8.0.2/configure --prefix=/home/gleb/.stack/programs/x86_64-linux/ghc-tinfo6-nopie-8.0.2/
@(System/Process/Log.hs:37:3)
Configuring GHC ...</code></pre>
<p>変更後は、こんな感じのログが続いて表示されるようになったようです。</p>
<pre class="shell"><code>...
018-01-03 10:49:29.280793: [debug] Run process within /home/kp/.stack/programs/x86_64-linux/ghc-7.10.3.temp/ghc-7.10.3/: /usr/bin/make install
@(subs/rio/src/RIO/Process.hs:191:3)
2018-01-03 10:49:29.304283: [info] /usr/bin/make -r --no-print-directory -f ghc.mk install BINDIST=YES NO_INCLUDE_DEPS=YES
@(Stack/Setup.hs:1096:54)
2018-01-03 10:49:29.737966: [info] &quot;rm&quot; -f utils/ghc-pkg/dist-install/build/Version.hs
@(Stack/Setup.hs:1096:54)
2018-01-03 10:49:29.739872: [info] echo &quot;module Version where&quot;                    &gt;&gt; utils/ghc-pkg/dist-install/build/Version.hs
@(Stack/Setup.hs:1096:54)
2018-01-03 10:49:29.741026: [info] echo &quot;version, targetOS, targetARCH :: String&quot; &gt;&gt; utils/ghc-pkg/dist-install/build/Version.hs
@(Stack/Setup.hs:1096:54)
2018-01-03 10:49:29.742170: [info] echo &quot;version    = \&quot;7.10.3\&quot;&quot;      &gt;&gt; utils/ghc-pkg/dist-install/build/Version.hs</code></pre>
<ul>
<li><strong>ファイルパスまたは git 参照から <code>extra-dep</code> が見つからなかった時のエラーメッセージが改善されました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3806">Confusing error message when a cabal file for an extra-dep can’t be found #3806</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3808">When a cabal file can’t be found, warn that extra-deps could be the problem too #3808</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>こんな感じでエラーメッセージが改善されたようです。</p>
<p><a href="https://user-images.githubusercontent.com/1274145/35401090-6f853812-01ad-11e8-8c02-622f9ea9c2da.png" target="_blank"><img src="https://user-images.githubusercontent.com/1274145/35401090-6f853812-01ad-11e8-8c02-622f9ea9c2da.png"></a></p>
<ul>
<li><strong>Windows 環境では Nix インテグレーションがサポートされていないため、明示的にフラグを有効にした場合でも常に無効になるように変更しました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3600">Nix doesn’t work on Windows #3600</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3833">Disable nix on windows (#3600) #3833</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong><code>stack build</code> に <code>--keep-tmp-files</code> フラグを追加しました。デバッグ目的のため一時的に作成したファイルやディレクトリを削除せずに残しておくことができます。このフラグは同等の機能を持つ ghc オプションと同時に使うと良いでしょう。例: <code>stack build --keep-tmp-files --ghc-options=-keep-tmp-files</code></strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3857">How to keep temporary files on build failures? #3857</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3858">stack build: Add –keep-tmp-files flag. Fixes #3857 #3858</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><code>stack.yaml</code> の <code>build</code> セクションに指定することもできるようです。(デフォルト値は <code>False</code>)</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb10-1" title="1"><span class="fu">build:</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="fu">library-profiling:</span><span class="at"> </span><span class="ch">false</span></a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="fu">executable-profiling:</span><span class="at"> </span><span class="ch">false</span></a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="fu">copy-bins:</span><span class="at"> </span><span class="ch">false</span></a>
<a class="sourceLine" id="cb10-5" title="5">  <span class="fu">prefetch:</span><span class="at"> </span><span class="ch">false</span></a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="fu">keep-going:</span><span class="at"> </span><span class="ch">false</span></a>
<a class="sourceLine" id="cb10-7" title="7">  <span class="fu">keep-tmp-files:</span><span class="at"> </span><span class="ch">false</span></a></code></pre></div>
<ul>
<li><strong>スナップショットのパーズ例外時のエラーメッセージを改善しました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3879">Improved error messages for snapshot parse exceptions #3879</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong><code>stack unpack</code> コマンドに <code>--to /target/directory</code> オプションが追加されました。パッケージの展開先を指定できるようになります。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3904">Possibility to specify a base path to unpack a package #3904</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3947">Add –to option to the unpack command to specify destination #3947</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong><code>stack hoogle</code> コマンドに <code>--server</code> オプションが追加されました。ローカルのポート8080番で Hoogle サーバーが起動します。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/2310">Add <code>stack hoogle --server</code> command #2310</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3941">Introduce Hoogle server command line option #3941</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><code>stack hoogle --server</code> は <code>stack hoogle -- server --local --port 8080</code> の省略形です。</p>
<h3 id="リリースノートに載ってない変更">リリースノートに載ってない変更</h3>
<ul>
<li><code>extra-deps</code> で <code>github</code> という短縮形が使えるようになりました。</li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3873">Allow github shorthand for extra-deps #3873</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3890">Allow ‘github’ shorthand for extra-deps (fixes #3873) #3890</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>以下のように書くことができます。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">-</span> <span class="fu">github:</span><span class="at"> commercialhaskell/rio</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="fu">commit:</span><span class="at"> 09654f9fcbdcd96d0f5102796b32fdac5da7260e</span></a></code></pre></div>
<p><code>commit</code> は短縮して記述することもできます。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode yaml"><code class="sourceCode yaml"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">-</span> <span class="fu">github:</span><span class="at"> commercialhaskell/rio</span></a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="fu">commit:</span><span class="at"> </span><span class="st">&quot;09654&quot;</span></a></code></pre></div>
<p><a href="https://github.com/mitchellwrosen/stack/blob/9489cf7d12c54ea40ab043e199d7850d2502e140/src/test/Stack/Types/BuildPlanSpec.hs">BuildPlanSpec.hs</a> にテストがいくつか載っていいるので、そこを見れば利用可能な形式がわかります。</p>
<h3 id="バグフィックス">バグフィックス</h3>
<ul>
<li><strong>スクリプトインタプリタ形式で暗黙的に渡されるファイル引数を他の引数より先に処理するようにしました。この修正により、スクリプト実行時に – +RTS … -RTS を渡せるようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3658">Error when using RTS options with the Stack script interpreter #3658</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3668">Put file arguments first when stack is run as script interpreter #3658 #3668</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><a href="./02-21-stack165.html">v.1.6.5</a> の時に紹介したので、そちらをご確認ください。</p>
<ul>
<li><strong>stack 設定ファイルで year パラメータが設定できるようになりました。それに伴い、ドキュメントもわかりやすくしました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/2275">stack new – AesonException #2275</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3701">Fix use of and document year template parameter #3701</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><a href="./02-21-stack165.html">v.1.6.5</a> の時に紹介したので、そちらをご確認ください。</p>
<ul>
<li><strong>ベンチーマークが別のベンチマークやビルドステップと並行して実行されてしまう問題を修正しました。これは別のプロセスのCPU利用がベンチマークに悪影響を及ぼすと思われるので理想的ではありません。また、デフォルトでベンチマークの出力が表示されないようになっていた件も同様に修正しました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3663">Benchmarks are run in parallel #3663</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3666">Never run benchmarks concurrently, always output to console #3663 #3666</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><a href="./02-21-stack165.html">v.1.6.5</a> の時に紹介したので、そちらをご確認ください。</p>
<ul>
<li><strong>stack ghci で複数のパッケージで定義されている同名のモジュールを読み込めるようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3776">Add rio package as a dep of stack #3776</a>
</li>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3779">With ghci, allow multiple packages to use the same module #3776 #3779</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><a href="./02-21-stack165.html">v.1.6.5</a> の時に紹介したので、そちらをご確認ください。</p>
<ul>
<li><strong>stack ghci で base の依存関係を追加する必要が無くなりました。これはローカルターゲットが存在しない場合に自動的に追加されるためです。これにより、base を置き換えているコードも同様に読み込めるようになります。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3589">stack ghci at global level missing base #3589</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/commit/196bdbae986ddf887f92999b26129085a8ed0be5">196bdbae986ddf887f92999b26129085a8ed0be5</a>
</li>
<li>
<a href="https://github.com/commercialhaskell/stack/commit/99950cfae2e014f76abbebd51869e5cae5f00a6a">99950cfae2e014f76abbebd51869e5cae5f00a6a</a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><a href="./02-21-stack165.html">v.1.6.5</a> の時に紹介したので、そちらをご確認ください。</p>
<ul>
<li><strong><code>stack ghci</code> コマンドで autogen ファイルのパスを適切に扱えるようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3791">Adjust <code>-i</code> paths used by ghci to point to autogen / etc files generated by newer Cabal #3791</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3795">Use per-component build directories for ghci with Cabal&gt;=2.0 #3791 #3795</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>stack はサブディレクトリを含むパッケージを常に再コンパイルしていました。現在は修正され、サブディレクトリを再コンパイルする必要がある時だけ行うようになりました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3899">hakyll dependency on nightly is not cached #3899</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3955">Don’t recompile in presence of sublibraries #3955</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p>特に <code>Hakyll</code> や <code>Pandoc</code> (依存しているライブラリも同様に影響を受ける) を使う場合に踏み抜く可能性があるため、影響を受けている人はアップグレード推奨です。</p>
<ul>
<li><code>get-stack.sh</code> インストールスクリプトにおいて Debian/Fedora/CentOS の依存関係のインストールをドキュメントの手動で行う場合と一致するように修正しました。</li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/commit/9dfff2760b659c84605028002cd6500cdb52c823#diff-e705c8fadf1193ab59443a5e6c8cbe8b">9dfff2760b659c84605028002cd6500cdb52c823</a>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><a href="https://docs.haskellstack.org/en/stable/install_and_upgrade/#manual-download_2">Manual Download</a> の内容と同様の処理になりました。(<code>git</code> と <code>gnupg</code> が追加されました)</p>
<ul>
<li><strong>Nix を利用する場合に gmp で Cabal-simple をコンパイルするように修正しました。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/2944">Nix: stack should compile setup-Simple-Cabal with libgmp #2944</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3971">#2944: Compile Cabal-simple with gmp when using Nix #3971</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<ul>
<li><strong><code>stack ghci</code> コマンドの stack 処理は ghci で置き換えられました。これによりシグナルハンドリングの動作が改善されます。特に Ctrl-C のハンドリングが改善されます。そのため、生成されたファイルは終了後に残ります。このパスはファイルコンテンツのハッシュにより決まり、システムの一時的なディレクトリに保存されます。そのため、必要に応じて綺麗にしましょう。</strong></li>
</ul>
<table class="border narrow">
<tbody>
<tr>
<th>
issue
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/issues/3821">stack repl exits on ctrl+c with error <stdin>: hGetChar: hardware fault (Input/output error) #3821</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
PR
</th>
<td>
<ul>
<li>
<a href="https://github.com/commercialhaskell/stack/pull/3869">Fix stack ghci ctrl c 3821 #3869</a>
</li>
</ul>
</td>
</tr>
<tr>
<th>
commit
</th>
<td>
</td>
</tr>
</tbody>
</table>
<p><code>stack repl</code> を実行すると、実際にはこんな感じでディレクトリとファイルが作られます。<code>ba125cb0</code> や <code>e4ed4429</code> というファイル名はファイルのコンテンツハッシュによって決まるそうです。(<code>tmp</code> というディレクトリ名は環境によって異なります)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1">$ <span class="ex">tree</span> /tmp/haskell-stack-ghci/</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="ex">/tmp/haskell-stack-ghci/</span></a>
<a class="sourceLine" id="cb13-3" title="3">├── <span class="ex">ba125cb0</span></a>
<a class="sourceLine" id="cb13-4" title="4">│   └── <span class="ex">cabal_macros.h</span></a>
<a class="sourceLine" id="cb13-5" title="5">└── <span class="ex">e4ed4429</span></a>
<a class="sourceLine" id="cb13-6" title="6">    └── <span class="ex">ghci-script</span></a>
<a class="sourceLine" id="cb13-7" title="7"></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="ex">2</span> directories, 2 files</a></code></pre></div>
<h2 id="changelog-オリジナル">Changelog (オリジナル)</h2>
<h3 id="release-notes">Release notes</h3>
<ul>
<li>aarch64 (64-bit ARM) bindists are now available for the first time.</li>
<li>Statically linked Linux bindists are no longer available, due to difficulty with GHC 8.2.2 on Alpine Linux.</li>
<li>32-bit Linux GMP4 bindists for CentOS 6 are no longer available, since GHC 8.2.2 is no longer being built for that platform.</li>
</ul>
<h3 id="major-changes">Major changes</h3>
<ul>
<li>Upgrade from Cabal 2.0 to Cabal 2.2</li>
</ul>
<h3 id="behavior-changes">Behavior changes</h3>
<ul>
<li><code>stack setup</code> no longer uses different GHC configure options on Linux distributions that use GCC with PIE enabled by default. GHC detects this itself since ghc-8.0.2, and Stack’s attempted workaround for older versions caused more problems than it solved.</li>
<li><code>stack new</code> no longer initializes a project if the project template contains a stack.yaml file.</li>
</ul>
<h3 id="other-enhancements">Other enhancements</h3>
<ul>
<li>A new sub command <code>ls</code> has been introduced to stack to view local and remote snapshots present in the system. Use <code>stack ls snapshots --help</code> to get more details about it.</li>
<li><code>list-dependencies</code> has been deprecated. The functionality has to accessed through the new <code>ls dependencies</code> interface. See <a href="https://github.com/commercialhaskell/stack/issues/3669">#3669</a> for details.</li>
<li>Specify User-Agent HTTP request header on every HTTP request. See <a href="https://github.com/commercialhaskell/stack/issues/3628">#3628</a> for details.</li>
<li><code>stack setup</code> looks for GHC bindists and installations by any OS key that is compatible (rather than only checking a single one). This is relevant on Linux where different distributions may have different combinations of libtinfo 5/6, ncurses 5/6, and gmp 4/5, and will allow simpifying the setup-info metadata YAML for future GHC releases.</li>
<li>The build progress bar reports names of packages currently building.</li>
<li><code>stack setup --verbose</code> causes verbose output of GHC configure process. See <a href="https://github.com/commercialhaskell/stack/issues/3716">#3716</a></li>
<li>Improve the error message when an <code>extra-dep</code> from a path or git reference can’t be found See <a href="https://github.com/commercialhaskell/stack/pull/3808">#3808</a></li>
<li>Nix integration is now disabled on windows even if explicitly enabled, since it isn’t supported. See <a href="https://github.com/commercialhaskell/stack/issues/3600">#3600</a></li>
<li><code>stack build</code> now supports a new flag <code>--keep-tmp-files</code> to retain intermediate files and directories for the purpose of debugging. It is best used with ghc’s equivalent flag, i.e. <code>stack build --keep-tmp-files --ghc-options=-keep-tmp-files</code>. See <a href="https://github.com/commercialhaskell/stack/issues/3857">#3857</a></li>
<li>Improved error messages for snapshot parse exceptions</li>
<li><code>stack unpack</code> now supports a <code>--to /target/directory</code> option to specify where to unpack the package into</li>
<li><code>stack hoogle</code> now supports a new flag <code>--server</code> that launches local Hoogle server on port 8080. See <a href="https://github.com/commercialhaskell/stack/issues/2310">#2310</a></li>
</ul>
<h3 id="bug-fixes">Bug fixes</h3>
<ul>
<li>The script interpreter’s implicit file arguments are now passed before other arguments. See <a href="https://github.com/commercialhaskell/stack/issues/3658">#3658</a>. In particular, this makes it possible to pass <code>-- +RTS ... -RTS</code> to specify RTS arguments used when running the script.</li>
<li>Don’t ignore the template <code>year</code> parameter in config files, and clarify the surrounding documentation. See <a href="https://github.com/commercialhaskell/stack/issues/2275">#2275</a>.</li>
<li>Benchmarks used to be run concurrently with other benchmarks and build steps. This is non-ideal because CPU usage of other processes may interfere with benchmarks. It also prevented benchmark output from being displayed by default. This is now fixed. See <a href="https://github.com/commercialhaskell/stack/issues/3663">#3663</a>.</li>
<li><code>stack ghci</code> now allows loading multiple packages with the same module name, as long as they have the same filepath. See <a href="https://github.com/commercialhaskell/stack/pull/3776">#3776</a>.</li>
<li><code>stack ghci</code> no longer always adds a dependency on <code>base</code>. It is now only added when there are no local targets. This allows it to be to load code that uses replacements for <code>base</code>. See <a href="https://github.com/commercialhaskell/stack/issues/3589#issuecomment">#3589</a></li>
<li><code>stack ghci</code> now uses correct paths for autogen files with <a href="https://github.com/commercialhaskell/stack/issues/3791">#3791</a></li>
<li>When a package contained sublibraries, stack was always recompiling the package. This has been fixed now, no recompilation is being done because of sublibraries. See <a href="https://github.com/commercialhaskell/stack/issues/3899">#3899</a>.</li>
<li>The <code>get-stack.sh</code> install script now matches manual instructions when it comes to Debian/Fedora/CentOS install dependencies.</li>
<li>Compile Cabal-simple with gmp when using Nix. See <a href="https://github.com/commercialhaskell/stack/issues/2944">#2944</a></li>
<li><code>stack ghci</code> now replaces the stack process with ghci. This improves signal handling behavior. In particular, handling of Ctrl-C. To make this possible, the generated files are now left behind after exit. The paths are based on hashing file contents, and it’s stored in the system temporary directory, so this shouldn’t result in too much garbage. See <a href="https://github.com/commercialhaskell/stack/issues/3821">#3821</a>.</li>
</ul>
      </article>

      <div class="row pager">
        <div class="col s6">
          
            <a class="waves-effect waves-light btn white-text left prev" href="../../posts/2018/04-18-hie.html"><i class="material-icons left">navigate_before</i>HIE でコード整形時に改行が追加されてしまうバグが直りました</a>
          
        </div>
        <div class="col s6">
          
            <a class="waves-effect waves-light btn white-text right next" href="../../posts/2018/05-14-release-extensible-049.html">extensible-0.4.9 がリリースされました。<i class="material-icons right">navigate_next</i></a>
          
        </div>
      </div>

      <div class="row">
        <div class="col s6 offset-s6" style="position: relative; height: 100px;">
          <div class="fixed-action-btn horizontal" style="position: absolute; display: inline-block; right: 24px;">
  <a class="btn-floating btn-large red">
    <i class="large material-icons">share</i>
  </a>
  <ul>
    <li>
      <a class="btn-floating waves-effect waves-light blue tooltipped" data-position="bottom" data-delay="20" data-tooltip="Share on Twitter" href="https://twitter.com/intent/tweet?text=Stack 1.7.1 がリリースされました。&url=https://haskell.e-bigmoon.com/posts/2018/05-04-stack171.html"><i class="mdi mdi-twitter white-text"></i></a>
    </li>
    <li>
      <a class="btn-floating waves-effect waves-light indigo tooltipped" data-position="bottom" data-delay="20" data-tooltip="Share on Facebook" href="https://facebook.com/sharer.php?u=https://haskell.e-bigmoon.com/posts/2018/05-04-stack171.html"><i class="mdi mdi-facebook white-text"></i></a>
    </li>
    <li>
      <a class="btn-floating waves-effect waves-light red tooltipped" data-position="bottom" data-delay="20" data-tooltip="Share on Google+" href="https://plus.google.com/share?url=https://haskell.e-bigmoon.com/posts/2018/05-04-stack171.html"><i class="mdi mdi-google-plus white-text"></i></a>
    </li>
  </ul>
</div>
        </div>
      </div>

    </div>
  </div>

  <!-- {% if page.mathjax %} -->
  <!--   {% include mathjax_support.html %} -->
  <!-- {% endif %} -->

</div>

      </div>
    </div>

    <footer class="page-footer indigo lighten-1">

  <div class="footer-copyright">

    <div class="container">
      © 2017-2019 BIGMOON&nbsp;
      Site proudly generated by <a class="red-text text-accent-1" href="http://jaspervdj.be/hakyll">Hakyll</a>,&nbsp;
      original Jekyll theme by <a class="red-text text-accent-1" href="https://github.com/mumuxme/materialize-jekyll">mumuxme</a>.
    </div>

  </div>

</footer>


    <!-- scrolltop button -->
    <button class="material-scrolltop waves-effect waves-light hide-on-small-only" type="button">
      <i class="mdi mdi-arrow-up-bold small white-text"></i>
    </button>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-19322672-9"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-19322672-9');
    </script>

    <!-- jquery -->
    <script type="text/javascript" src="../../lib/jquery-min.js"></script>
    <!-- materialize -->
    <script src="../../lib/materialize/js/materialize.min.js"></script>
    <!-- <\!-- Material ScrollTop plugin -\-> -->
    <script src="../../lib/material-scrolltop/material-scrolltop.js"></script>
    <!-- main -->
    <script src="../../js/init.js"></script>
    <script src="../../js/main.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>

</html>
